# Multi-Camera Inference Configuration for VGGT

# debug: true

# =============== Model Configuration ===============
model: "VGGT(img_size=518, patch_size=14, embed_dim=1024, sh_degree=0, use_gs_head=True, use_gs_head_velocity=True, use_gs_head_segment=False, use_gt_camera=True, velocity_head_small_init=False)"

# Model checkpoint path
model_path: "checkpoints/new/start/checkpoint-epoch_0_4166.pth"

# =============== Dataset Configuration ===============
# Multi-camera mode dataset
infer_dataset: Waymo_Multi(
  ROOT="data/waymo/train_full",
  valid_camera_id_list=["1", "2", "3"],
  intervals=[5],
  resolution=[(518, 336)],
  transform=ImgNorm,
  num_views=${num_context_frames},
  multi_camera_mode=True,
  zero_ground_velocity=True)

# Number of context frames (sparse frames for inference)
# With interval=5, total frames loaded = num_context_frames * 5
# Example: num_context_frames=4, interval=5 -> 20 total frames (context: 0,5,10,15; target: 1-4,6-9,11-14,16-19)
num_context_frames: 4

# =============== Inference Configuration ===============
# Batch processing mode
batch_mode: true
start_idx: 2
end_idx: 100
step: 1

# Single sample mode (used when batch_mode=false)
single_idx: 0

# Device configuration
device: "cuda"

# Visualization configuration
fps: 10
save_video: true
save_images: false

# Target frame visualization control
# false: Only visualize context frames (default, traditional mode)
# true: Use STORM-style layout with context frames at top as reference, visualize target frames below
render_target_frames: true

# =============== Gaussian Splatting Configuration ===============
sh_degree: 0
use_gt_camera: true              # Use GT camera parameters

# =============== Dynamic Object Processing Configuration ===============
# Velocity transform mode: "simple" (translation only) or "procrustes" (rotation+translation)
velocity_transform_mode: "procrustes"

# Dynamic object detection thresholds
velocity_threshold: 0.1           # Velocity threshold (m/s)
clustering_eps: 0.3              # DBSCAN neighborhood radius
clustering_min_samples: 10       # DBSCAN minimum samples
min_object_size: 500             # Minimum object size (points)

# Object tracking thresholds
tracking_position_threshold: 2.0  # Position matching threshold (meters)
tracking_velocity_threshold: 0.2  # Velocity matching threshold (m/s)

# =============== Output Configuration ===============
output_dir: "./results/multi_camera"
output_prefix: "waymo_multi"        # Output filename prefix
continue_on_error: true             # Continue to next sample on error

# =============== Hydra Configuration ===============
hydra:
  verbose: False
  run:
    dir: ${output_dir}/hydra_logs
