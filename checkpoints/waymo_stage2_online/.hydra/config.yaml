debug: true
model: VGGT(img_size=518, patch_size=14, embed_dim=1024, use_sky_token=False)
pretrained: /mnt/teams/algo-teams/yuxue.yang/4DVideo/ziqi/4DVideo/src/checkpoints/waymo/step2(true+fixmodel+lowlr!+nolpips+onlyflow+velocitylocal+fromscratch)/checkpoint-epoch_2_17880.pth
auxiliary_models:
  flow: RAFT(RAFTCfg(name="kitti-M", dataset="kitti", path="/mnt/teams/algo-teams/yuxue.yang/4DVideo/ziqi/4DVideo/src/Tartan-C-T-TSKH-kitti432x960-M.pth",
    use_var=True, var_min=0, var_max=10, pretrain="resnet34", initial_dim=64, block_dims=[64,
    128, 256], radius=4, dim=128, num_blocks=2, iters=4, image_size=[432, 960], offload=${offload_auxiliary},
    geo_thresh=2, photo_thresh=-1))
offload_auxiliary: false
load_only_encoder: false
long_context: false
fixed_length: true
resume: null
benchmark: true
num_views: 8
num_test_views: 2
n_corres_train: 0
n_corres_test: 0
enable_stage2: true
stage2_start_epoch: 0
stage2_frequency: 1
stage2_memory_efficient: true
stage2_training_mode: joint
stage2_learning_rate: 8.0e-06
input_gaussian_dim: 14
output_gaussian_dim: 11
gaussian_feature_dim: 128
gaussian_num_layers: 4
gaussian_num_heads: 8
gaussian_mlp_ratio: 4.0
pose_feature_dim: 128
pose_num_heads: 8
pose_num_layers: 3
max_points_per_object: 2048
stage2_rgb_loss_weight: 1.0
stage2_depth_loss_weight: 0.0
stage2_lpips_loss_weight: 0.1
stage2_consistency_loss_weight: 0.0
stage2_gaussian_reg_weight: 0.0
stage2_pose_reg_weight: 0.0
stage2_temporal_smooth_weight: 0.0
sam2_model_cfg: sam2_hiera_l.yaml
sam2_checkpoint: checkpoints/sam2_hiera_large.pt
confidence_threshold: 0.25
min_mask_area: 200
max_objects_per_frame: 4
tracking_memory_length: 8
optical_flow_model: RAFT
min_object_size: 200
velocity_threshold_percentile: 0.7
use_optical_flow_aggregation: true
train_criterion: RenderLoss(MSE, shape="BHWC") + 0.1 * RenderLoss(LPIPS, shape="BCHW")
test_criterion: RenderLoss(MSE, shape="BHWC")
resolution:
- (518
- 378)
- (518
- 336)
- (518
- 294)
- (518
- 252)
- (518
- 210)
- (518
- 140)
- (378
- 518)
- (336
- 518)
- (294
- 518)
- (252
- 518)
allow_repeat: false
train_dataset: Waymo_Multi(allow_repeat=${allow_repeat}, split=None, ROOT="/mnt/teams/algo-teams/yuxue.yang/4DVideo/preprocessed_dataset/waymo/test",
  img_ray_mask_p=[1.0, 0.0, 0.0], valid_camera_id_list=["1"], aug_crop=0, resolution=[(518,
  378),(518, 336),(518, 294),(518, 252),(518, 210),(518, 140),(378, 518),(336, 518),(294,
  518),(252, 518)], transform=ImgNorm, num_views=${num_views}, n_corres=${n_corres_train},
  seq_aug_crop=True, load_sam_masks=True)
test_dataset: 1000 @ Waymo_Multi(split=None, ROOT="/mnt/teams/algo-teams/yuxue.yang/4DVideo/preprocessed_dataset/waymo/train",
  img_ray_mask_p=[1.0, 0.0, 0.0], valid_camera_id_list=["1", "2", "3"], resolution=[(518,
  378),(518, 336),(518, 294),(518, 252),(518, 210),(518, 140),(378, 518),(336, 518),(294,
  518),(252, 518)], num_views=${num_test_views}, seed=42, n_corres=${n_corres_test},
  seq_aug_crop=True)
seed: 0
batch_size: 1
accum_iter: 2
gradient_checkpointing: true
epochs: 50
start_epoch: 0
weight_decay: 0.05
lr: 3.0e-06
min_lr: 5.0e-07
warmup_epochs: 2
amp: 1
num_workers: 8
world_size: 1
local-rank: -1
dist_url: env://
rank: 0
gpu: 0
distributed: false
dist_backend: nccl
eval_freq: 2
save_freq: 5
keep_freq: 10
print_freq: 1
print_img_freq: 1000
num_imgs_vis: 6
save_dir: checkpoints
exp_name: waymo_stage2_online
task: vggt
logdir: ./${save_dir}/${exp_name}/logs
output_dir: ./${save_dir}/${exp_name}/
